<!doctype html>
<html>
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <title>MRBrew by Marc Ransome</title>

    <link rel="stylesheet" href="stylesheets/styles.css">
    <link rel="stylesheet" href="stylesheets/pygment_trac.css">
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
  </head>
  <body>
    <div class="wrapper">
      <header>
        <h1>MRBrew</h1>
        <p>An Objective-C wrapper library for the Homebrew package manager.</p>

        <p class="view"><a href="https://github.com/marcransome/MRBrew">View the Project on GitHub <small>marcransome/MRBrew</small></a></p>


        <ul>
          <li><a href="https://github.com/marcransome/MRBrew/zipball/master">Download <strong>ZIP File</strong></a></li>
          <li><a href="https://github.com/marcransome/MRBrew/tarball/master">Download <strong>TAR Ball</strong></a></li>
          <li><a href="https://github.com/marcransome/MRBrew">View On <strong>GitHub</strong></a></li>
        </ul>
      </header>
      <section>
        <h2>
<a name="mrbrew-" class="anchor" href="#mrbrew-"><span class="octicon octicon-link"></span></a>MRBrew <a href="https://travis-ci.org/marcransome/MRBrew"><img src="http://img.shields.io/travis/marcransome/MRBrew.svg" alt="Build Status"></a>
</h2>

<p>MRBrew is a simple Objective-C wrapper library for the <a href="http://brew.sh">Homebrew</a> package manager.  It makes performing Homebrew operations from your apps a breeze:</p>

<div class="highlight highlight-objc"><pre><span class="n">MRBrewOperation</span> <span class="o">*</span><span class="n">operation</span> <span class="o">=</span> <span class="p">[</span><span class="n">MRBrewOperation</span> <span class="n">installOperation</span><span class="o">:</span><span class="p">[</span><span class="n">MRBrewFormula</span> <span class="n">formulaWithName</span><span class="o">:</span><span class="s">@"vim"</span><span class="p">]];</span>
<span class="p">[[</span><span class="n">MRBrew</span> <span class="n">sharedBrew</span><span class="p">]</span> <span class="n">performOperation</span><span class="o">:</span><span class="n">operation</span> <span class="n">delegate</span><span class="o">:</span><span class="nb">nil</span><span class="p">];</span>
</pre></div>

<p>Now you have a <a href="http://www.vim.org">powerful text editor</a> installed. <img class="emoji" title=":beer:" alt=":beer:" src="https://github.global.ssl.fastly.net/images/icons/emoji/beer.png" height="20" width="20" align="absmiddle"></p>

<h2>
<a name="project-integration" class="anchor" href="#project-integration"><span class="octicon octicon-link"></span></a>Project integration</h2>

<p>MRBrew can be integrated into an existing project using <a href="http://cocoapods.org">CocoaPods</a>. Simply add the necessary dependency to your <code>Podfile</code> as follows:</p>

<div class="highlight highlight-ruby"><pre><span class="n">platform</span> <span class="ss">:osx</span><span class="p">,</span> <span class="s1">'10.7'</span>
<span class="n">pod</span> <span class="s1">'MRBrew'</span>
<span class="o">.</span><span class="n">.</span><span class="o">.</span>
</pre></div>

<p>Then install the dependency into your project:</p>

<p><code>$ pod install</code></p>

<h2>
<a name="prerequisites" class="anchor" href="#prerequisites"><span class="octicon octicon-link"></span></a>Prerequisites</h2>

<p><code>MRBrew</code> depends on Homebrew for the heavy lifting, and assumes the default installation path of <code>/usr/local/bin/brew</code> (though this can be specified if the <code>brew</code> executable has been moved).  If you don't have Homebrew installed, follow the <a href="http://brew.sh">official instructions</a> to get brewing.</p>

<h2>
<a name="general-usage" class="anchor" href="#general-usage"><span class="octicon octicon-link"></span></a>General Usage</h2>

<h4>
<a name="performing-operations" class="anchor" href="#performing-operations"><span class="octicon octicon-link"></span></a>Performing operations</h4>

<p>To perform an operation, pass an <code>MRBrewOperation</code> object to the shared <code>MRBrew</code> instance using the <code>performOperation:delegate:</code> method.</p>

<p>The <code>MRBrewOperation</code> class provides a number of convenience methods for creating objects that represent common Homebrew operations:</p>

<div class="highlight highlight-objc"><pre><span class="k">+</span> <span class="p">(</span><span class="n">instancetype</span><span class="p">)</span><span class="nf">updateOperation</span><span class="p">;</span>
<span class="k">+</span> <span class="p">(</span><span class="n">instancetype</span><span class="p">)</span><span class="nf">listOperation</span><span class="p">;</span>
<span class="k">+</span> <span class="p">(</span><span class="n">instancetype</span><span class="p">)</span><span class="nf">searchOperation:</span><span class="p">(</span><span class="n">MRBrewFormula</span> <span class="o">*</span><span class="p">)</span><span class="nv">formula</span><span class="p">;</span>
<span class="k">+</span> <span class="p">(</span><span class="n">instancetype</span><span class="p">)</span><span class="nf">installOperation:</span><span class="p">(</span><span class="n">MRBrewFormula</span> <span class="o">*</span><span class="p">)</span><span class="nv">formula</span><span class="p">;</span>
<span class="k">+</span> <span class="p">(</span><span class="n">instancetype</span><span class="p">)</span><span class="nf">infoOperation:</span><span class="p">(</span><span class="n">MRBrewFormula</span> <span class="o">*</span><span class="p">)</span><span class="nv">formula</span><span class="p">;</span>
<span class="k">+</span> <span class="p">(</span><span class="n">instancetype</span><span class="p">)</span><span class="nf">removeOperation:</span><span class="p">(</span><span class="n">MRBrewFormula</span> <span class="o">*</span><span class="p">)</span><span class="nv">formula</span><span class="p">;</span>
<span class="k">+</span> <span class="p">(</span><span class="n">instancetype</span><span class="p">)</span><span class="nf">optionsOperation:</span><span class="p">(</span><span class="n">MRBrewFormula</span> <span class="o">*</span><span class="p">)</span><span class="nv">formula</span><span class="p">;</span>
</pre></div>

<p>For example, the following code would perform a Homebrew <code>update</code> operation:</p>

<div class="highlight highlight-objc"><pre><span class="p">[[</span><span class="n">MRBrew</span> <span class="n">sharedBrew</span><span class="p">]</span> <span class="n">performOperation</span><span class="o">:</span><span class="p">[</span><span class="n">MRBrewOperation</span> <span class="n">updateOperation</span><span class="p">]</span> <span class="n">delegate</span><span class="o">:</span><span class="nb">nil</span><span class="p">];</span>
</pre></div>

<p>Operations that require a formula to be specified should be passed an <code>MRBrewFormula</code> object, which is just as easy to create. For example:</p>

<div class="highlight highlight-objc"><pre><span class="n">MRBrewOperation</span> <span class="o">*</span><span class="n">operation</span> <span class="o">=</span> <span class="p">[</span><span class="n">MRBrewOperation</span> <span class="n">installOperation</span><span class="o">:</span><span class="p">[</span><span class="n">MRBrewFormula</span> <span class="n">formulaWithName</span><span class="o">:</span><span class="s">@"appledoc"</span><span class="p">]];</span>
<span class="p">[[</span><span class="n">MRBrew</span> <span class="n">sharedBrew</span><span class="p">]</span> <span class="n">performOperation</span><span class="o">:</span><span class="n">operation</span> <span class="n">delegate</span><span class="o">:</span><span class="nb">nil</span><span class="p">];</span>
</pre></div>

<p>Each call to <code>performOperation:delegate:</code> spawns a subprocess in a separate thread that won't interrupt processing in the rest of your app.  Multiple operations can be performed by making repeated calls to <code>performOperation:delegate:</code>.  Operations are placed into a queue and executed concurrently. If you would prefer operations to execute in series, just call <code>[MRBrew setConcurrentOperations:NO]</code>.</p>

<p><strong>Note:</strong> All operations performed by the <code>MRBrew</code> class inherit the environment from which those operation were launched. Use <code>setEnvironment:</code> to define your own environment variables.</p>

<h4>
<a name="custom-operations" class="anchor" href="#custom-operations"><span class="octicon octicon-link"></span></a>Custom operations</h4>

<p>The convenience methods provided by <code>MRBrewOperation</code> cover only a small subset of the actual operations supported by Homebrew.  To perform an operation that does not already have an associated convenience method defined, use the following <code>MRBrewOperation</code> class method when creating your operation object:</p>

<div class="highlight highlight-objc"><pre><span class="k">+</span> <span class="p">(</span><span class="n">instancetype</span><span class="p">)</span><span class="nf">operationWithName:</span><span class="p">(</span><span class="n">NSString</span> <span class="o">*</span><span class="p">)</span><span class="nv">name</span>
                          <span class="nl">formula:</span><span class="p">(</span><span class="n">MRBrewFormula</span> <span class="o">*</span><span class="p">)</span><span class="nv">formula</span>
                       <span class="nl">parameters:</span><span class="p">(</span><span class="n">NSArray</span> <span class="o">*</span><span class="p">)</span><span class="nv">parameters</span><span class="p">;</span>
</pre></div>

<p>Specify the operation name exactly as defined by Homebrew (e.g. <code>@"upgrade"</code>). Both <code>formula</code> and <code>parameters</code> may be optional depending upon the operation being performed (see <em>man brew</em> for more details).</p>

<h4>
<a name="handling-operation-output" class="anchor" href="#handling-operation-output"><span class="octicon octicon-link"></span></a>Handling operation output</h4>

<p>You'll probably want to be notified when an operation has finished, failed, or generated output.  This can be achieved using the delegate pattern by implementing the <code>MRBrewDelegate</code> protocol in your controller and specifying the following optional methods:</p>

<div class="highlight highlight-objc"><pre><span class="k">-</span> <span class="p">(</span><span class="kt">void</span><span class="p">)</span><span class="nf">brewOperationDidFinish:</span><span class="p">(</span><span class="n">MRBrewOperation</span> <span class="o">*</span><span class="p">)</span><span class="nv">operation</span><span class="p">;</span>
<span class="k">-</span> <span class="p">(</span><span class="kt">void</span><span class="p">)</span><span class="nf">brewOperation:</span><span class="p">(</span><span class="n">MRBrewOperation</span> <span class="o">*</span><span class="p">)</span><span class="nv">operation</span> <span class="nf">didFailWithError:</span><span class="p">(</span><span class="n">NSError</span> <span class="o">*</span><span class="p">)</span><span class="nv">error</span><span class="p">;</span>
<span class="k">-</span> <span class="p">(</span><span class="kt">void</span><span class="p">)</span><span class="nf">brewOperation:</span><span class="p">(</span><span class="n">MRBrewOperation</span> <span class="o">*</span><span class="p">)</span><span class="nv">operation</span> <span class="nf">didGenerateOutput:</span><span class="p">(</span><span class="n">NSString</span> <span class="o">*</span><span class="p">)</span><span class="nv">output</span><span class="p">;</span>
</pre></div>

<p>Now, whenever you perform an operation with <code>performOperation:delegate:</code>, specify your controller object as the delegate in order to receive callbacks when an operation has finished, failed, or generated output:</p>

<div class="highlight highlight-objc"><pre><span class="p">[[</span><span class="n">MRBrew</span> <span class="n">sharedBrew</span><span class="p">]</span> <span class="n">performOperation</span><span class="o">:</span><span class="p">[</span><span class="n">MRBrewOperation</span> <span class="n">updateOperation</span><span class="p">]</span> <span class="n">delegate</span><span class="o">:</span><span class="n">controller</span><span class="p">];</span>
</pre></div>

<p>If you expect your controller to manage (and therefore receive callbacks for) multiple types of operation, you should inspect the <code>MRBrewOperation</code> object in your delegate methods to determine how to respond to particular types of operation:</p>

<div class="highlight highlight-objc"><pre><span class="k">-</span> <span class="p">(</span><span class="kt">void</span><span class="p">)</span><span class="nf">brewOperation:</span><span class="p">(</span><span class="n">MRBrewOperation</span> <span class="o">*</span><span class="p">)</span><span class="nv">operation</span> <span class="nf">didGenerateOutput:</span><span class="p">(</span><span class="n">NSString</span> <span class="o">*</span><span class="p">)</span><span class="nv">output</span>
<span class="p">{</span>
    <span class="k">if</span> <span class="p">([[</span><span class="n">operation</span> <span class="n">name</span><span class="p">]</span> <span class="n">isEqualToString</span><span class="o">:</span><span class="n">MRBrewOperationUpdateIdentifier</span><span class="p">])</span> <span class="p">{</span>
        <span class="c1">// an update operation produced output</span>
    <span class="p">}</span>
    <span class="k">else</span> <span class="k">if</span> <span class="p">([[</span><span class="n">operation</span> <span class="n">name</span><span class="p">]</span> <span class="n">isEqualToString</span><span class="o">:</span><span class="n">MRBrewOperationInstallIdentifier</span><span class="p">])</span> <span class="p">{</span>
        <span class="c1">// an install operation produced output</span>
    <span class="p">}</span>
    <span class="p">...</span>
<span class="p">}</span>
</pre></div>

<p>The constants referenced above can be found in the <code>MRBrewConstants.h</code> header and are used to determine the type of operation received by your delegate methods.  Import this header in your delegate implementation if you plan to use these constants.</p>

<p>If you are responding to a custom operation that does not already have a constant defined, simply provide your own, or use a string literal:</p>

<div class="highlight highlight-objc"><pre><span class="k">if</span> <span class="p">([[</span><span class="n">operation</span> <span class="n">name</span><span class="p">]</span> <span class="n">isEqualToString</span><span class="o">:</span><span class="s">@"audit"</span><span class="p">])</span> <span class="p">{</span>
    <span class="c1">// an audit operation produced output</span>
<span class="p">}</span>
</pre></div>

<p>Alternatively, if you need to respond in your delegate methods to a specific operation, use the <code>isEqualToOperation:</code> method of the <code>MRBrewOperation</code> class to confirm the operation that generated the callback and respond accordingly.</p>

<h4>
<a name="cancelling-operations" class="anchor" href="#cancelling-operations"><span class="octicon octicon-link"></span></a>Cancelling operations</h4>

<p>Operations can be cancelled using one of the following <code>MRBrew</code> instance methods (remember to obtain a a reference to the shared <code>MRBrew</code> instance using the <code>+sharedBrew</code> class method first):</p>

<div class="highlight highlight-objc"><pre><span class="k">-</span> <span class="p">(</span><span class="kt">void</span><span class="p">)</span><span class="nf">cancelAllOperations</span><span class="p">;</span>
<span class="k">-</span> <span class="p">(</span><span class="kt">void</span><span class="p">)</span><span class="nf">cancelOperation:</span><span class="p">(</span><span class="n">MRBrewOperation</span> <span class="o">*</span><span class="p">)</span><span class="nv">operation</span><span class="p">;</span>
<span class="k">-</span> <span class="p">(</span><span class="kt">void</span><span class="p">)</span><span class="nf">cancelAllOperationsOfType:</span><span class="p">(</span><span class="n">MRBrewOperationType</span><span class="p">)</span><span class="nv">type</span><span class="p">;</span>
</pre></div>

<h4>
<a name="miscellaneous" class="anchor" href="#miscellaneous"><span class="octicon octicon-link"></span></a>Miscellaneous</h4>

<p>If the <code>brew</code> executable has been moved outside of the default <code>/usr/local/bin/</code> directory (generally not advisable), specify its location before performing any operations:</p>

<div class="highlight highlight-objc"><pre><span class="p">[[</span><span class="n">MRBrew</span> <span class="n">sharedBrew</span><span class="p">]</span> <span class="n">setBrewPath</span><span class="o">:</span><span class="s">@"/usr/bin/brew"</span><span class="p">];</span>
</pre></div>

<p>This call only needs to be made once per project.</p>

<h2>
<a name="contributions" class="anchor" href="#contributions"><span class="octicon octicon-link"></span></a>Contributions</h2>

<p>If you plan to contribute to the MRBrew project, <a href="https://help.github.com/articles/fork-a-repo">fork the repository</a>, make your code changes, then submit a pull request with a brief description of your feature or bug fix.  Test suites and unit tests are provided for the <code>MRBrewTests</code> target, and additional test methods should be added where necessary.</p>

<h2>
<a name="documentation" class="anchor" href="#documentation"><span class="octicon octicon-link"></span></a>Documentation</h2>

<p>Visit <a href="http://cocoadocs.org/docsets/MRBrew/">CocoaDocs</a> for additional documentation, or alternatively inspect the header files directly.</p>

<h2>
<a name="caveats" class="anchor" href="#caveats"><span class="octicon octicon-link"></span></a>Caveats</h2>

<p>The source code for <code>MRBrew</code> uses Automatic Reference Counting and has only been tested against 10.7—10.9 deployment targets.</p>

<h2>
<a name="license" class="anchor" href="#license"><span class="octicon octicon-link"></span></a>License</h2>

<p><code>MRBrew</code> is provided under the terms of the <a href="http://opensource.org/licenses/mit-license.php">MIT License</a>.</p>

<h2>
<a name="acknowledgements" class="anchor" href="#acknowledgements"><span class="octicon octicon-link"></span></a>Acknowledgements</h2>

<p>The following libraries were used in the making of <code>MRBrew</code>:</p>

<ul>
<li>
<a href="http://ocmock.org">OCMock</a> by Mulle Kybernetik</li>
</ul><h2>
<a name="contact" class="anchor" href="#contact"><span class="octicon octicon-link"></span></a>Contact</h2>

<p>Email me at <a href="mailto:marc.ransome@fidgetbox.co.uk">marc.ransome@fidgetbox.co.uk</a> or tweet <a href="http://www.twitter.com/marcransome">@marcransome</a>.</p>
      </section>
      <footer>
        <p>This project is maintained by <a href="https://github.com/marcransome">marcransome</a></p>
        <p><small>Hosted on GitHub Pages &mdash; Theme by <a href="https://github.com/orderedlist">orderedlist</a></small></p>
      </footer>
    </div>
    <script src="javascripts/scale.fix.js"></script>
              <script type="text/javascript">
            var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
            document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
          </script>
          <script type="text/javascript">
            try {
              var pageTracker = _gat._getTracker("UA-31478860-1");
            pageTracker._trackPageview();
            } catch(err) {}
          </script>

  </body>
</html>